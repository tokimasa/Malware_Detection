# -*- coding: utf-8 -*-
"""
Created on Thu Mar 15 19:29:24 2018

@author: TOKIMASA
"""
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from dimension_reduction import *

dataset_df = pd.read_csv('dataset.csv')

label_df = pd.read_csv('training-set.csv', names=['FileID','Label'], header=None)
data_df = label_df.merge(dataset_df, on='FileID', how='left')
data_df = data_df[['Customer_Count','Max_Customer_Repeat','Product_Count','Max_Product_Repeat','Night_Ratio','Label']]

sns.set(style="ticks")
sns.pairplot(data_df, hue="Label")

sns.set(style="white")
g = sns.PairGrid(data_df, diag_sharey=False)
g.map_lower(sns.kdeplot, cmap="Blues_d")
g.map_upper(plt.scatter)
g.map_diag(sns.kdeplot, lw=3)

h = sns.PairGrid(data_df[data_df.Label==0][['Customer_Count','Max_Customer_Repeat','Product_Count','Max_Product_Repeat','Night_Ratio']], diag_sharey=False)
h.map_lower(sns.kdeplot, cmap="BuGn_r")
h.map_upper(plt.scatter)
h.map_diag(sns.kdeplot, lw=3)

h = sns.PairGrid(data_df[data_df.Label==1][['Customer_Count','Max_Customer_Repeat','Product_Count','Max_Product_Repeat','Night_Ratio']], diag_sharey=False)
h.map_lower(sns.kdeplot, cmap="BuGn_r")
h.map_upper(plt.scatter)
h.map_diag(sns.kdeplot, lw=3)

x_tsne = get_tsne_2d_array(data_df[['Customer_Count','Max_Customer_Repeat','Product_Count','Max_Product_Repeat','Night_Ratio']])
x_pca = get_pca_2d_array(data_df[['Customer_Count','Max_Customer_Repeat','Product_Count','Max_Product_Repeat','Night_Ratio']])

sns.set(style="ticks")
sns.pairplot(x_tsne, hue=data_df.Label)